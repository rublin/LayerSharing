# Layer Backend Engineer Test

This is Spring Boot microservice that provides API for saving, updating and receiving sharings.
As a microservice, it should fit microservice infrastructure (including config, discovery and other services).

## How to build

Use [maven](https://maven.apache.org/download.cgi) as a build tool or just download the [latest build](https://github.com/rublin/LayerSharing/releases/download/0.1/sharing-0.0.1-SNAPSHOT.jar)

```
mvn clean install
```

## How to run

Maven provides an executable jar including the application server (Tomcat).

```
java -jar sharing-0.0.1-SNAPSHOT.jar
```

The microservice runs with default configuration on port 8080.
If you have to change the default configuration, you should create an [external configuration file](https://docs.spring.io/spring-boot/docs/current/reference/html/boot-features-external-config.html#boot-features-external-config-application-property-files).

### By default it connects to the cloud SQL server that may response slowly.

## Who will generate a new document

A new document should be generated by another microservice. It's better to use an event (any **JMS** like ActiveMQ or Axon) to notify that microservice about new/modified sharings. The event can be sent from the **ShareService** class (I left the TODO).

## API design

I used a classic MVC pattern. As a DB used PostgreSQL, but it can be easily replaced by another SQL or noSQL database.
The API contains only two endpoints:
1. POST /shares for creating new sharings and modify existing.
 _//ToTo create a different PUT endpoint to modify_
2. GET /shares for receiving all stored shares

To try the API you can use [Swagger](http://localhost:8080/swagger-ui.html#/sharing-rest-controller).

### curl examples

Get all sharings
```
curl -X GET "http://localhost:8080/shares" -H  "accept: */*"
```
Post new sharing
```
curl -X POST "http://localhost:8080/shares" -H  "accept: */*" -H  "Content-Type: application/json" -d "{"emails":[{"email":"test2@test.com"},{"email":"test31@test.com"}],"selections":[{"selection":"Actuals!B5:C1"},{"selection":"Dashboard!B4"},{"selection":"'Assumptions'"}]}"
```
Update existing sharign
```
curl -X POST "http://localhost:8080/shares" -H  "accept: */*" -H  "Content-Type: application/json" -d "{\"emails\":[{\"email\":\"qwerty@test.com\"}],\"selections\":[{\"id\":7,\"selection\":\"Actuals!B5:C1\"}]}"
```

## TODO

1. Tests are necessary, but I spent much more time than expected.
2. Custom validation regarding to Sheet enum.
3. Custom exceptions and handlers in REST controller
